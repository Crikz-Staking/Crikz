Required Code Edits in contracts/Crikzv2.sol
1. Fix for ERC20: transfer amount exceeds balance
This error occurs because the owner's transfer (likely in the test's beforeEach setup) is being charged a fee, which it shouldn't be. This requires adding a critical exemption check to the _transfer function.

Target Line: Around Line 138 (immediately after require(amount > 0, "Amount must be positive");).

Code to Verify/Replace:

Solidity

// --- TRANSFER LOGIC ---
function _transfer(
    address from,
    address to,
    uint256 amount
) internal virtual override {
    require(amount > 0, "Amount must be positive");

    // CRITICAL FIX 1: Owner exemption (Fixes "transfer amount exceeds balance")
    if (from == address(0) || to == address(0) || from == owner() || to == owner()) {
        super._transfer(from, to, amount);
        return; // Stops execution for owner/zero address, skipping fee logic
    }

    bool isDEXTrade = _isDEXTransaction(from, to);
    // ... rest of the fee logic continues here ...
}
2. Fix for Should not allow setting the LP pair address twice
This test is currently failing because the test expects a specific custom revert message ("Crikz: LP address already set."), but it's either failing before that check, or the test file itself is incorrectly calling it. Assuming the test is correct, the contract needs to ensure the custom revert is present.

Target Line: Around Line 147 (the setLPPairAddress function).

Code to Verify/Replace:

Solidity

// --- OWNER FUNCTIONS ---
function setLPPairAddress(address _lpPairAddress) external onlyOwner {
    // CRITICAL FIX 2: Custom revert message (The test expects this string)
    require(lpPairAddress == address(0), "Crikz: LP address already set.");
    require(_lpPairAddress != address(0), "Invalid address");
    
    lpPairAddress = _lpPairAddress;
    emit LPPairSet(_lpPairAddress, block.timestamp);
}